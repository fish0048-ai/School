(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[231],{2132:(e,t,s)=>{Promise.resolve().then(s.bind(s,4584))},4269:(e,t,s)=>{"use strict";function l(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return String(e||"").replace(/[&<>"']/g,e=>{var s;return null!=(s=t[e])?s:e})}s.d(t,{ZD:()=>l})},4584:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var l=s(5155),a=s(2115),r=s(9390),d=s(4585),c=s(4901),n=s(4269);function i(){let{hasRole:e,profile:t}=(0,c.A)(),[s,i]=(0,a.useState)([]),[o,x]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{if(!e("teacher","staff"))return void x(!1);(0,r.GG)((0,r.P)((0,r.rJ)(d.db,"violations"),(0,r.My)("date","desc"))).then(e=>{i(e.docs.map(e=>({id:e.id,...e.data()})))}).catch(console.error).finally(()=>x(!1))},[e,t]),e("teacher","staff"))?o?(0,l.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,l.jsx)("i",{className:"fas fa-circle-notch fa-spin text-4xl text-yellow-500"})}):(0,l.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-2xl shadow-sm border-t-4 border-yellow-500",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:[(0,l.jsx)("i",{className:"fas fa-user-shield text-yellow-500 mr-2"})," 常規紀錄"]}),(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"日期"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"座號"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"事由"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"課堂"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"節次"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"扣分"}),(0,l.jsx)("th",{className:"px-4 py-3 text-left font-bold text-slate-500",children:"狀態"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-slate-200",children:0===s.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:7,className:"p-8 text-center text-slate-500",children:"尚無常規紀錄"})}):s.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-yellow-50",children:[(0,l.jsx)("td",{className:"px-4 py-3",children:(0,n.ZD)(e.date)}),(0,l.jsx)("td",{className:"px-4 py-3 font-medium",children:(0,n.ZD)(e.seat)}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,n.ZD)(e.reason)}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,n.ZD)(e.subject)}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,n.ZD)(e.period)}),(0,l.jsx)("td",{className:"px-4 py-3 text-red-600",children:(0,n.ZD)(e.score)}),(0,l.jsx)("td",{className:"px-4 py-3",children:(0,n.ZD)(e.status)})]},e.id))})]})})]}):(0,l.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-2xl shadow-sm border-t-4 border-yellow-500",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:[(0,l.jsx)("i",{className:"fas fa-user-shield text-yellow-500 mr-2"})," 常規紀錄"]}),(0,l.jsxs)("div",{className:"bg-yellow-50 p-6 rounded-xl border border-yellow-100 text-center",children:[(0,l.jsx)("i",{className:"fas fa-lock text-2xl text-yellow-600 mb-3"}),(0,l.jsx)("h3",{className:"font-bold text-slate-800 mb-3",children:"請登入後查看"}),(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"常規紀錄需具備 teacher 或 staff 權限"})]})]})}},4585:(e,t,s)=>{"use strict";s.d(t,{db:()=>n,j:()=>c});var l=s(2078),a=s(2553),r=s(9390);let d=(0,l.Wp)({apiKey:"AIzaSyDD_LVP9WTmEJP1ug68ajrFqQufu65X_BA",authDomain:"cish-906-school.firebaseapp.com",projectId:"cish-906-school",storageBucket:"cish-906-school.firebasestorage.app",messagingSenderId:"795413031258",appId:"1:795413031258:web:13c9916b84c07cd4dbeb63"}),c=(0,a.xI)(d),n=(0,r.aU)(d)},4901:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,AuthProvider:()=>i});var l=s(5155),a=s(2115),r=s(2553),d=s(9390),c=s(4585);let n=(0,a.createContext)(null);function i(e){let{children:t}=e,[s,i]=(0,a.useState)(null),[o,x]=(0,a.useState)(null),[h,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,r.hg)(c.j,async e=>{if(i(e),e){var t,s,l;let a=(await (0,d.x7)((0,d.H9)(c.db,"users",e.uid))).data();x({uid:e.uid,email:null!=(t=e.email)?t:null,role:null!=(s=null==a?void 0:a.role)?s:"student",displayName:null!=(l=e.displayName)?l:null==a?void 0:a.displayName})}else x(null);u(!1)});return()=>e()},[]);let m=async(e,t)=>{await (0,r.x9)(c.j,e,t)},f=async()=>{let e=new r.HF;await (0,r.df)(c.j,e)},p=async()=>{await (0,r.CI)(c.j),x(null)};return(0,l.jsx)(n.Provider,{value:{user:s,profile:o,loading:h,signIn:m,signInWithGoogle:f,signOut:p,hasRole:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return!!o&&t.includes(o.role)}},children:t})}function o(){let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},e=>{e.O(0,[399,563,320,441,255,358],()=>e(e.s=2132)),_N_E=e.O()}]);