(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{17:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var l=s(5155),a=s(2115),r=s(2619),n=s.n(r),u=s(63),i=s(4901);function o(){let[e,t]=(0,a.useState)(""),[s,r]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[c,m]=(0,a.useState)(!1),{signIn:h,signInWithGoogle:x}=(0,i.A)(),b=(0,u.useRouter)(),f=async t=>{t.preventDefault(),d(""),m(!0);try{await h(e,s),b.push("/")}catch(e){d(e instanceof Error?e.message:"登入失敗，請檢查帳號密碼")}finally{m(!1)}},p=async()=>{d(""),m(!0);try{await x(),b.push("/")}catch(e){d(e instanceof Error?e.message:"Google 登入失敗")}finally{m(!1)}};return(0,l.jsx)("div",{className:"min-h-[60vh] flex items-center justify-center",children:(0,l.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-8 w-full max-w-md",children:[(0,l.jsxs)("h2",{className:"text-2xl font-bold text-slate-800 mb-6 text-center",children:[(0,l.jsx)("i",{className:"fas fa-sign-in-alt text-blue-500 mr-2"}),"登入 906 親師平台"]}),o&&(0,l.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-600 rounded-lg text-sm",children:o}),(0,l.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"電子郵件"}),(0,l.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),className:"w-full p-3 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"your@email.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"密碼"}),(0,l.jsx)("input",{type:"password",value:s,onChange:e=>r(e.target.value),className:"w-full p-3 border border-slate-300 rounded-lg outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,l.jsxs)("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[c?(0,l.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}):null,"登入"]})]}),(0,l.jsxs)("div",{className:"mt-6 flex items-center gap-4",children:[(0,l.jsx)("div",{className:"flex-1 h-px bg-slate-200"}),(0,l.jsx)("span",{className:"text-slate-400 text-sm",children:"或"}),(0,l.jsx)("div",{className:"flex-1 h-px bg-slate-200"})]}),(0,l.jsxs)("button",{type:"button",onClick:p,disabled:c,className:"mt-6 w-full flex items-center justify-center gap-2 bg-white border border-slate-300 text-slate-700 font-bold py-3 rounded-lg hover:bg-slate-50",children:[(0,l.jsx)("i",{className:"fab fa-google text-red-500"}),"Google 登入"]}),(0,l.jsx)("p",{className:"mt-6 text-center text-slate-500 text-sm",children:(0,l.jsx)(n(),{href:"/",className:"text-blue-500 hover:underline",children:"返回首頁"})})]})})}},63:(e,t,s)=>{"use strict";var l=s(7260);s.o(l,"usePathname")&&s.d(t,{usePathname:function(){return l.usePathname}}),s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}})},243:(e,t,s)=>{Promise.resolve().then(s.bind(s,17))},4585:(e,t,s)=>{"use strict";s.d(t,{db:()=>i,j:()=>u});var l=s(2078),a=s(2553),r=s(9390);let n=(0,l.Wp)({apiKey:"AIzaSyDD_LVP9WTmEJP1ug68ajrFqQufu65X_BA",authDomain:"cish-906-school.firebaseapp.com",projectId:"cish-906-school",storageBucket:"cish-906-school.firebasestorage.app",messagingSenderId:"795413031258",appId:"1:795413031258:web:13c9916b84c07cd4dbeb63"}),u=(0,a.xI)(n),i=(0,r.aU)(n)},4901:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,AuthProvider:()=>o});var l=s(5155),a=s(2115),r=s(2553),n=s(9390),u=s(4585);let i=(0,a.createContext)(null);function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[d,c]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,r.hg)(u.j,async e=>{if(o(e),e){var t,s,l;let a=(await (0,n.x7)((0,n.H9)(u.db,"users",e.uid))).data();c({uid:e.uid,email:null!=(t=e.email)?t:null,role:null!=(s=null==a?void 0:a.role)?s:"student",displayName:null!=(l=e.displayName)?l:null==a?void 0:a.displayName})}else c(null);h(!1)});return()=>e()},[]);let x=async(e,t)=>{await (0,r.x9)(u.j,e,t)},b=async()=>{let e=new r.HF;await (0,r.df)(u.j,e)},f=async()=>{await (0,r.CI)(u.j),c(null)};return(0,l.jsx)(i.Provider,{value:{user:s,profile:d,loading:m,signIn:x,signInWithGoogle:b,signOut:f,hasRole:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return!!d&&t.includes(d.role)}},children:t})}function d(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},e=>{e.O(0,[399,563,320,619,441,255,358],()=>e(e.s=243)),_N_E=e.O()}]);